angular.module("wordscrambleapp",["ngAnimate"]),angular.module("wordscrambleapp").controller("WordScrambleCtrl",function(e,r,n,t,o){"use strict";e.wordCount=0,e.words=new Array,e.wordUnscrambled="",e.wordScrambled="",e.lettersScrambled=new Array,e.lettersScrambledCopy="",e.lettersEntered=new Array,e.swapCount=0,e.swapIndexes=new Array,e.correct=!1,e.incorrect=!1,e.score=0,e.countdown=60,e.doneToggled=!1,e.initialize=function(){o.get("http://api.wordnik.com:80/v4/words.json/randomWords?hasDictionaryDef=true&minCorpusCount=1000000&maxCorpusCount=-1&minDictionaryCount=1&maxDictionaryCount=-1&minLength=4&maxLength=7&limit=50&api_key=a2a73e7b926c924fad7001ca3111acd55af2ffabf50eb4ae5").success(function(n,t,o,a){for(var d=0;d<n.length;d++){var c=n[d].word.toUpperCase();e.words.push(c)}e.wordUnscrambled=e.words[e.wordCount],e.wordScrambled=r("scramble")(e.wordUnscrambled),e.lettersScrambled=e.wordScrambled.split(""),e.lettersScrambledCopy=e.lettersScrambled.slice(),e.decrementCountdown()}).error(function(e,r,n,t){})},e.initialize(),e.decrementCountdown=function(){t(function(){e.countdown--,0===e.countdown?e.done():e.decrementCountdown()},1e3)},e.moveElement=function(e,r,n){if(n>=e.length)for(var t=n-e.length;t--+1;)e.push(void 0);return e.splice(n,0,e.splice(r,1)[0]),e},e.done=function(){e.doneToggled=!0},e.reset=function(){e.wordCount=0,e.words=new Array,e.wordUnscrambled="",e.wordScrambled="",e.lettersScrambled=new Array,e.lettersScrambledCopy="",e.lettersEntered=new Array,e.swapCount=0,e.swapIndexes=new Array,e.correct=!1,e.incorrect=!1,e.score=0,e.countdown=60,e.doneToggled=!1,e.initialize()},n.$on("keydown",function(r,n,t){e.$apply(function(){if(8===n.which&&e.lettersEntered.length>0){e.lettersEntered.pop();var r=e.swapIndexes.pop();e.swapCount--,e.moveElement(e.lettersScrambled,e.swapCount,r)}var r=e.lettersScrambled.indexOf(t,e.swapCount);t&&r>-1&&(e.lettersEntered.push(t),e.swapIndexes.push(r),e.moveElement(e.lettersScrambled,r,e.swapCount),e.swapCount++)})}),e.$watch("lettersEntered.length",function(n,o){if(n===e.wordUnscrambled.length&&n>0){var a=e.lettersEntered.join("");a===e.wordUnscrambled?(e.correct=!0,t(function(){e.correct=!1,e.wordCount++,e.wordUnscrambled=e.words[e.wordCount],e.wordScrambled=r("scramble")(e.wordUnscrambled),e.lettersScrambled=e.wordScrambled.split(""),e.lettersScrambledCopy=e.lettersScrambled.slice(),e.lettersEntered=new Array,e.swapCount=0,e.swapIndexes=new Array,e.score+=100},1e3)):(e.incorrect=!0,t(function(){e.incorrect=!1,e.lettersEntered=new Array,e.lettersScrambled=e.lettersScrambledCopy.slice(),e.swapCount=0,e.swapIndexes=new Array},1e3))}})}),angular.module("wordscrambleapp").directive("keydown",function(e,r){return{restrict:"A",link:function(){console.log("linked"),e.bind("keydown",function(e){8===e.which&&e.preventDefault(),r.$broadcast("keydown",e,String.fromCharCode(e.which))})}}}),angular.module("wordscrambleapp").filter("scramble",function(){return function(e){for(var r=e.split(""),n=r.length,t=n-1;t>0;t--){var o=Math.floor(Math.random()*(t+1)),a=r[t];r[t]=r[o],r[o]=a}return r.join("")}});